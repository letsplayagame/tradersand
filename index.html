<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradersAnD - Traders Angels and Demons</title>
    <style>
        :root {
            --primary-brown: #8B4513;
            --light-brown: #DEB887;
            --dark-brown: #654321;
            --beige: #F5F5DC;
            --sage: #9CAF88;
            --success: #4F7942;
            --error: #8B0000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: var(--beige);
            color: var(--dark-brown);
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background-color: var(--light-brown);
            padding: 15px;
            border-radius: 5px;
        }

        .score {
            font-size: 24px;
            font-weight: bold;
        }

        .score.positive { color: var(--success); }
        .score.negative { color: var(--error); }

        .window {
            background-color: var(--sage);
            padding: 10px;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: white;
        }

        th, td {
            border: 1px solid var(--light-brown);
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: var(--light-brown);
            color: var(--dark-brown);
        }

        .action-btn {
            cursor: pointer;
            padding: 5px 10px;
            background-color: var(--sage);
            border: none;
            border-radius: 3px;
            color: white;
        }

        .log-section {
            margin-top: 20px;
        }

        .log-entry {
            display: flex;
            gap: 10px;
            margin-bottom: 5px;
            align-items: center;
        }

        .config-screen {
            display: none;
        }

        .screen-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: var(--primary-brown);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        input[type="text"], input[type="number"] {
            padding: 5px;
            border: 1px solid var(--light-brown);
            border-radius: 3px;
        }

        .warning {
            color: var(--error);
            font-size: 0.9em;
            margin-top: 5px;
        }
    </style>
</head>


<body>
    <div class="main-screen">
        <button class="screen-toggle">Configuration</button>
        
        <div class="header">
            <div class="ac-table">
                <table>
                    <tr>
                        <th></th>
                        <th>Lucky</th>
                        <th>Unlucky</th>
                    </tr>
                    <tr>
                        <td>Angels</td>
                        <td id="lucky-angels">0</td>
                        <td id="unlucky-angels">0</td>
                    </tr>
                    <tr>
                        <td>Demons</td>
                        <td id="lucky-demons">0</td>
                        <td id="unlucky-demons">0</td>
                    </tr>
                </table>
            </div>
            <div class="score" id="total-score">Points: 0</div>
            <div class="window">
                <div id="ny-time"></div>
                <div id="session-message"></div>
            </div>
        </div>

        <div class="actions-section">
            <div class="angels-section">
                <h2>ðŸ‘¼ ANGELS ðŸ‘¼</h2>
                <table id="angels-table">
                    <thead>
                        <tr>
                            <th>Action Item</th>
                            <th>Count</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="demons-section">
                <h2>ðŸ˜ˆ DEMONS ðŸ˜ˆ</h2>
                <table id="demons-table">
                    <thead>
                        <tr>
                            <th>Action Item</th>
                            <th>Count</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div class="log-section">
            <h2>Actions Log</h2>
            <button id="clear-logs" class="action-btn">Clear All Logs</button>
            <div id="log-entries"></div>
        </div>
    </div>

    <div class="config-screen">
        <button class="screen-toggle">Main Screen</button>
        
        <h2>Configuration</h2>
        
        <div class="config-section">
            <h3>Angels Configuration</h3>
            <table id="angels-config">
                <thead>
                    <tr>
                        <th>Action Item</th>
                        <th>Multiplier (1-5)</th>
                        <th>Max Occurrence (2-20)</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <button id="add-angel" class="action-btn">Add Angel</button>
        </div>

        <div class="config-section">
            <h3>Demons Configuration</h3>
            <table id="demons-config">
                <thead>
                    <tr>
                        <th>Action Item</th>
                        <th>Multiplier (1-5)</th>
                        <th>Max Occurrence (2-20)</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <button id="add-demon" class="action-btn">Add Demon</button>
        </div>
    </div>
</body>


    <script>
    // Constants
    const STORAGE_KEYS = {
        ANGELS: 'tradersand_angels',
        DEMONS: 'tradersand_demons',
        LOGS: 'tradersand_logs'
    };

    const TIME_MESSAGES = {
        ETH: { start: '00:00', end: '09:30', message: 'ETH' },
        AM: { start: '09:30', end: '12:00', message: 'AM Session' },
        PM: { start: '12:00', end: '16:00', message: 'PM Session' }
    };

    // State Management
    let angels = JSON.parse(localStorage.getItem(STORAGE_KEYS.ANGELS)) || [];
    let demons = JSON.parse(localStorage.getItem(STORAGE_KEYS.DEMONS)) || [];
    let logs = JSON.parse(localStorage.getItem(STORAGE_KEYS.LOGS)) || [];

    // Helper Functions
    function saveState() {
        localStorage.setItem(STORAGE_KEYS.ANGELS, JSON.stringify(angels));
        localStorage.setItem(STORAGE_KEYS.DEMONS, JSON.stringify(demons));
        localStorage.setItem(STORAGE_KEYS.LOGS, JSON.stringify(logs));
    }

    function getNYTime() {
        return new Date().toLocaleString('en-US', {
            timeZone: 'America/New_York',
            hour12: false,
            hour: '2-digit',
            minute: '2-digit'
        });
    }

    function getSessionMessage() {
        const nyTime = getNYTime();
        for (const [key, period] of Object.entries(TIME_MESSAGES)) {
            if (nyTime >= period.start && nyTime < period.end) {
                return period.message;
            }
        }
        return 'Market Closed';
    }

    function calculateScore() {
        const angelScore = logs
            .filter(log => angels.find(a => a.action === log.action))
            .reduce((sum, log) => {
                const angel = angels.find(a => a.action === log.action);
                return sum + angel.multiplier;
            }, 0);

        const demonScore = logs
            .filter(log => demons.find(d => d.action === log.action))
            .reduce((sum, log) => {
                const demon = demons.find(d => d.action === log.action);
                return sum + demon.multiplier;
            }, 0);

        return angelScore - demonScore;
    }

    function updateACTable() {
        const counts = {
            luckyAngels: 0,
            unluckyAngels: 0,
            luckyDemons: 0,
            unluckyDemons: 0
        };

        logs.forEach(log => {
            if (angels.find(a => a.action === log.action)) {
                log.lucky ? counts.luckyAngels++ : counts.unluckyAngels++;
            } else {
                log.lucky ? counts.luckyDemons++ : counts.unluckyDemons++;
            }
        });

        document.getElementById('lucky-angels').textContent = counts.luckyAngels;
        document.getElementById('unlucky-angels').textContent = counts.unluckyAngels;
        document.getElementById('lucky-demons').textContent = counts.luckyDemons;
        document.getElementById('unlucky-demons').textContent = counts.unluckyDemons;
    }

    function updateScore() {
        const score = calculateScore();
        const scoreElement = document.getElementById('total-score');
        scoreElement.textContent = `Points: ${score}`;
        scoreElement.className = `score ${score >= 0 ? 'positive' : 'negative'}`;
    }

    function renderActionTables() {
        const angelsTable = document.getElementById('angels-table').getElementsByTagName('tbody')[0];
        const demonsTable = document.getElementById('demons-table').getElementsByTagName('tbody')[0];

        angelsTable.innerHTML = '';
        demonsTable.innerHTML = '';

        angels.forEach(angel => {
            const count = logs.filter(log => log.action === angel.action).length;
            const row = angelsTable.insertRow();
            row.innerHTML = `
                <td>${angel.action}</td>
                <td>${count}/${angel.maxOccurrence}</td>
            `;
            row.addEventListener('click', () => addLogEntry(angel.action, true));
        });

        demons.forEach(demon => {
            const count = logs.filter(log => log.action === demon.action).length;
            const row = demonsTable.insertRow();
            row.innerHTML = `
                <td>${demon.action}</td>
                <td>${count}/${demon.maxOccurrence}</td>
            `;
            row.addEventListener('click', () => addLogEntry(demon.action, false));
        });
    }

    function addLogEntry(action, isAngel) {
        const count = logs.filter(log => log.action === action).length;
        const actionConfig = isAngel ? 
            angels.find(a => a.action === action) : 
            demons.find(d => d.action === action);

        if (count >= actionConfig.maxOccurrence) {
            alert(`Warning: Maximum occurrence (${actionConfig.maxOccurrence}) reached for "${action}"`);
        }

        const log = {
            time: getNYTime(),
            action,
            note: '',
            lucky: false
        };

        logs.unshift(log);
        saveState();
        renderLogs();
        updateACTable();
        updateScore();
    }

    function renderLogs() {
        const logContainer = document.getElementById('log-entries');
        logContainer.innerHTML = '';

        logs.forEach((log, index) => {
            const isAngel = angels.find(a => a.action === log.action);
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `
                <input type="text" value="${log.time}" style="width: 60px">
                <span>${log.action}</span>
                <input type="text" value="${log.note}" placeholder="Add note...">
                <label>
                    <input type="checkbox" ${log.lucky ? 'checked' : ''}>
                    ${isAngel ? 'Unlucky' : 'Lucky'}
                </label>
                <button class="action-btn">Delete</button>
            `;

            const timeInput = logEntry.querySelector('input[type="text"]');
            const noteInput = logEntry.querySelectorAll('input[type="text"]')[1];
            const luckyCheckbox = logEntry.querySelector('input[type="checkbox"]');
            const deleteButton = logEntry.querySelector('button');

            timeInput.addEventListener('change', (e) => {
                log.time = e.target.value;
                saveState();
            });

            noteInput.addEventListener('change', (e) => {
                log.note = e.target.value;
                saveState();
            });

            luckyCheckbox.addEventListener('change', (e) => {
                log.lucky = e.target.checked;
                saveState();
                updateACTable();
            });

            deleteButton.addEventListener('click', () => {
                logs.splice(index, 1);
                saveState();
                renderLogs();
                updateACTable();
                updateScore();
            });

            logContainer.appendChild(logEntry);
        });
    }

    function renderConfigTables() {
        const angelsConfig = document.getElementById('angels-config').getElementsByTagName('tbody')[0];
        const demonsConfig = document.getElementById('demons-config').getElementsByTagName('tbody')[0];

        angelsConfig.innerHTML = '';
        demonsConfig.innerHTML = '';

        function createConfigRow(item, isAngel) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="text" value="${item.action}"></td>
                <td><input type="number" value="${item.multiplier}" min="1" max="5"></td>
                <td><input type="number" value="${item.maxOccurrence}" min="2" max="20"></td>
                <td><button class="action-btn">Delete</button></td>
            `;

            const inputs = row.getElementsByTagName('input');
            const deleteButton = row.getElementsByTagName('button')[0];

            Array.from(inputs).forEach(input => {
                input.addEventListener('change', () => {
                    item.action = inputs[0].value;
                    item.multiplier = parseInt(inputs[1].value);
                    item.maxOccurrence = parseInt(inputs[2].value);
                    saveState();
                    renderActionTables();
                });
            });

            deleteButton.addEventListener('click', () => {
                const array = isAngel ? angels : demons;
                const index = array.indexOf(item);
                array.splice(index, 1);
                saveState();
                renderConfigTables();
                renderActionTables();
            });

            return row;
        }

        angels.forEach(angel => {
            angelsConfig.appendChild(createConfigRow(angel, true));
        });

        demons.forEach(demon => {
            demonsConfig.appendChild(createConfigRow(demon, false));
        });
    }

    // Event Listeners
    document.querySelectorAll('.screen-toggle').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelector('.main-screen').style.display = 
                document.querySelector('.main-screen').style.display === 'none' ? 'block' : 'none';
            document.querySelector('.config-screen').style.display = 
                document.querySelector('.config-screen').style.display === 'none' ? 'block' : 'none';
        });
    });

    document.getElementById('add-angel').addEventListener('click', () => {
        angels.push({ action: 'New Angel', multiplier: 1, maxOccurrence: 2 });
        saveState();
        renderConfigTables();
        renderActionTables();
    });

    document.getElementById('add-demon').addEventListener('click', () => {
        demons.push({ action: 'New Demon', multiplier: 1, maxOccurrence: 2 });
        saveState();
        renderConfigTables();
        renderActionTables();
    });

    document.getElementById('clear-logs').addEventListener('click', () => {
        if (confirm('Are you sure you want to clear all logs?')) {
            logs = [];
            saveState();
            renderLogs();
            updateACTable();
            updateScore();
        }
    });

    // Initialize
    function updateClock() {
        document.getElementById('ny-time').textContent = getNYTime();
        document.getElementById('session-message').textContent = getSessionMessage();
    }

    // Start the app
    renderActionTables();
    renderConfigTables();
    renderLogs();
    updateACTable();
    updateScore();
    updateClock();
    setInterval(updateClock, 60000);
</script>
